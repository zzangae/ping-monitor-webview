<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ping ì‘ë‹µ í™•ì¸ ì‹œê°í™” ë„êµ¬ v2.7</title>
    <link rel="stylesheet" href="/web/css/variables.css">
    <link rel="stylesheet" href="/web/css/base.css">
    <link rel="stylesheet" href="/web/css/components.css">
    <link rel="stylesheet" href="/web/css/dashboard.css">
    <link rel="stylesheet" href="/web/css/notifications.css">
    <link rel="stylesheet" href="/web/css/outages.css">
    <link rel="stylesheet" href="/web/css/settings.css">
    <link rel="stylesheet" href="/web/css/responsive.css">
    <link rel="stylesheet" href="/web/config/settings.css">
    <link rel="stylesheet" href="/web/section-ip/timeline.css">
    <script src="/web/chart.umd.min.js"></script>
    <script src="/web/section-ip/timeline.js"></script>
    <script src="/web/config/settings.js"></script>
    <style>
        
        /* ìµœì†Œí™”ëœ IP ì¹´ë“œ ìŠ¤íƒ€ì¼ ìˆ˜ì • */
        .minimized-cards-container {
            padding: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .ip-card.minimized {
            width: auto;
            min-width: 80px;
            max-width: 120px;
            padding: 8px;
            padding-bottom: 12px;
            overflow: visible;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        /* ìµœì†Œí™”ëœ ì¹´ë“œì˜ IP ì´ë¦„ - í•œ ì¤„ë¡œ ì œí•œ */
        .ip-card.minimized .ip-name {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100px;
            text-align: center;
            font-size: 11px;
        }
        
        /* ìµœì†Œí™”ëœ ì¹´ë“œì˜ ìƒíƒœ ë±ƒì§€ */
        .ip-card.minimized .status-badge {
            margin-top: 6px;
            margin-bottom: 4px;
            font-size: 10px;
            padding: 2px 8px;
        }
        
        /* ìµœì†Œí™” ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .minimize-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .minimize-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .minimize-btn svg {
            transition: transform 0.3s ease;
        }
        
        .minimize-btn.minimized svg {
            transform: rotate(180deg);
        }
        
        /* ëª¨ë‹¬ ìŠ¤í¬ë¡¤ ë°©ì§€ */
        .modal.active {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
        
        /* íƒ€ì„ë¼ì¸ ì‹œê°„ ë²”ìœ„ ë¼ë²¨ */
        #timelineRangeLabel {
            color: var(--primary);
            font-weight: 500;
            margin-left: 4px;
        }
        
        /* í™˜ê²½ì„¤ì • ëª¨ë‹¬ í•˜ë‹¨ ì €ì¥ ë²„íŠ¼ */
        .settings-footer {
            padding: 16px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: flex-end;
            background: rgba(0, 0, 0, 0.2);
        }
        
        .settings-footer .btn {
            min-width: 100px;
        }
        
        /* ê¸°ì¤€ ì‹œê°„ ì…ë ¥ + ìŠ¬ë¼ì´ë” ê·¸ë£¹ */
        .threshold-input-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .threshold-input-group .settings-input {
            width: 100px;
            flex-shrink: 0;
        }
        
        .threshold-input-group .threshold-slider {
            flex: 1;
        }
        
        /* í…Œì´ë¸” ë‚´ ìŠ¬ë¼ì´ë” */
        .threshold-table input[type="range"] {
            width: 100%;
            min-width: 80px;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, #3a3f5c, #4a5080);
            border-radius: 4px;
            outline: none;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .threshold-table input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border: 2px solid #fff;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4), 0 0 4px rgba(255, 215, 0, 0.5);
        }
        
        .threshold-table input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.25);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8), 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .threshold-table input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border: 2px solid #fff;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4), 0 0 4px rgba(255, 215, 0, 0.5);
        }
        
        /* ê¸°ë³¸ ê¸°ì¤€ ì‹œê°„ìš© ìŠ¬ë¼ì´ë” */
        .threshold-slider {
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, #3a3f5c, #4a5080);
            border-radius: 4px;
            outline: none;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .threshold-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 22px;
            height: 22px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border: 2px solid #fff;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4), 0 0 4px rgba(255, 215, 0, 0.5);
        }
        
        .threshold-slider::-webkit-slider-thumb:hover {
            transform: scale(1.25);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8), 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .threshold-slider::-moz-range-thumb {
            width: 22px;
            height: 22px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border: 2px solid #fff;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4), 0 0 4px rgba(255, 215, 0, 0.5);
        }
        
        .modal-content {
            max-height: 85vh;
            overflow: hidden;
        }
        
        .modal-body {
            max-height: 70vh;
            overflow-y: auto;
        }
        
        /* ìµœìƒë‹¨ í—¤ë” - ê³ ì • í•´ì œ ë° ë†’ì´ ìµœì†Œí™” */
        .header {
            position: relative !important;
            padding: 8px 20px !important;
            min-height: auto !important;
        }
        
        .header h1 {
            font-size: 1.2rem !important;
            margin: 0 !important;
        }
        
        .header-subtitle {
            font-size: 0.75rem !important;
            margin-top: 2px !important;
        }
    </style>

</head>
<body>
    <!-- Header -->
    <div class="header" id="mainHeader">
        <h1>ğŸŒ Ping ì‘ë‹µ í™•ì¸ ì‹œê°í™” ë„êµ¬ v2.7</h1>
        <div class="header-subtitle">ë‹¤ìˆ˜ì˜ IPì— ëŒ€í•œ ping ì‘ë‹µ ê²°ê³¼ë¥¼ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•©ë‹ˆë‹¤</div>
    </div>

    <!-- Tab Navigation -->
        <div class="container">
        <div class="tab-nav">
            <button class="tab-btn active" data-tab="dashboard">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
            <button class="tab-btn" data-tab="notifications">ğŸ”” ì•Œë¦¼ ê¸°ë¡</button>
            <button class="tab-btn" data-tab="outages">ğŸ“‹ ë¯¸ì‘ë‹µ ê¸°ë¡</button>
        </div>

        <!-- Dashboard Tab -->
        <div class="tab-content active" id="dashboard">
            <!-- Unified Control Bar -->
            <div class="unified-control-bar">
                <!-- Time Info -->
                <div class="control-group">
                    <div class="time-display">
                        <div class="time-label">í˜„ì¬ ì‹œê°„</div>
                        <div class="time-value large" id="currentTime">00:00:00</div>
                    </div>
                    <div class="time-display">
                        <div class="time-label">í˜„ì¬ ë‚ ì§œ</div>
                        <div class="time-value" id="currentDate">0000-00-00</div>
                    </div>
                    <div class="time-display">
                        <div class="time-label">ì‹¤í–‰ ì‹œê°„</div>
                        <div class="time-value" id="uptime">00:00:00</div>
                    </div>
                </div>
                
                <div class="control-divider"></div>
                
                <!-- Tab & Control Buttons -->
                <div class="control-group">
                    <button type="button" class="btn btn-primary" id="toggleBtn">ì¼ì‹œì •ì§€</button>
                    <button type="button" class="btn btn-success" id="refreshBtn">ìƒˆë¡œê³ ì¹¨</button>
                </div>
                
                <div class="control-divider"></div>
                
                <!-- Stats -->
                <div class="control-group" style="flex: 1; justify-content: space-around;">
                    <div class="stat-item-inline">
                        <div class="stat-label">ì „ì²´ IP</div>
                        <div class="stat-value" id="totalIPs">0</div>
                    </div>
                    <div class="stat-item-inline">
                        <div class="stat-label">ì˜¨ë¼ì¸</div>
                        <div class="stat-value" style="color: var(--success);" id="onlineCount">0</div>
                    </div>
                    <div class="stat-item-inline">
                        <div class="stat-label">ì˜¤í”„ë¼ì¸</div>
                        <div class="stat-value" style="color: var(--error);" id="offlineCount">0</div>
                    </div>
                    <div class="stat-item-inline">
                        <div class="stat-label">í‰ê·  ì§€ì—°</div>
                        <div class="stat-value" id="avgLatency">0</div>
                    </div>
                </div>
                
                <div class="control-divider"></div>
                
                <!-- Sort Controls -->
                <div class="control-group">
                    <button class="card-sort-btn" id="sortByName">ì´ë¦„ìˆœ</button>
                    <button class="card-sort-btn" id="sortByLatency">ì§€ì—°ìˆœ</button>
                    <button class="card-sort-btn" id="sortByStatus">ìƒíƒœìˆœ</button>
                </div>
            </div>

            <!-- Comparison Chart -->
            <div class="card" id="comparisonChartCard">
                <div class="card-header">
                    <div class="card-title" id="timelineTitle">IP ë¹„êµ íƒ€ì„ë¼ì¸ <span id="timelineRangeLabel">(1ë¶„)</span></div>
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <button class="chart-settings-btn" id="chartSettingsBtn" title="í™˜ê²½ì„¤ì •">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path d="M12 1v6m0 6v6m5.2-13.2l-4.3 4.3M7.8 16.4l-4.3 4.3M23 12h-6m-6 0H1m17.8-5.2l-4.3 4.3M7.8 7.8L3.5 3.5"></path>
                            </svg>
                        </button>
                        <button class="minimize-btn" id="timelineMinimizeBtn" title="íƒ€ì„ë¼ì¸ ìµœì†Œí™”/í™•ëŒ€">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="18 15 12 9 6 15"></polyline>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="collapsible-content" id="timelineContent">
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Chart Settings Modal -->
            <div class="modal" id="chartSettingsModal">
                <div class="modal-content settings-modal-content">
                    <div class="modal-header">
                        <h3>í™˜ê²½ì„¤ì •</h3>
                        <button class="modal-close" id="closeChartSettings">&times;</button>
                    </div>
                    
                    <!-- Settings Tabs (ê³ ì •) -->
                    <div class="settings-tabs-row">
                        <button class="settings-tab-btn active" data-settings-tab="chart">
                            ğŸ“Š ì°¨íŠ¸ ì„¤ì •
                        </button>
                        <button class="settings-tab-btn" data-settings-tab="timerange">
                            â±ï¸ ì‹œê°„ ë²”ìœ„
                        </button>
                        <button class="settings-tab-btn" data-settings-tab="thresholds">
                            ğŸ¯ ê·¸ë£¹ë³„ ì„¤ì •
                        </button>
                        <button class="settings-tab-btn" data-settings-tab="ipgroups">
                            ğŸ“‹ IP ê·¸ë£¹ ê´€ë¦¬
                        </button>
                    </div>
                    
                    <div class="settings-success" id="settingsSuccess" style="margin: 0 20px 16px 20px;">
                        âœ“ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!
                    </div>
                    
                    <!-- íƒ­ ë‚´ìš© ì˜ì—­ -->
                    <div class="settings-tab-container">
                
                <!-- Tab 1: ì°¨íŠ¸ ì„¤ì • (ê¸°ì¡´) -->
                <div class="settings-tab-content active" id="settings-chart">
                    <div class="chart-settings-controls">
                        <button class="btn btn-sm btn-secondary" id="selectAllIPs">ì „ì²´ ì„ íƒ</button>
                        <button class="btn btn-sm btn-secondary" id="deselectAllIPs">ì „ì²´ í•´ì œ</button>
                    </div>
                    <div class="settings-scroll-box" id="ipCheckboxList">
                        <!-- IP ì²´í¬ë°•ìŠ¤ê°€ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                </div>
                
                <!-- Tab 2: ì‹œê°„ ë²”ìœ„ (v2.7) -->
                <div class="settings-tab-content" id="settings-timerange">
                    <div class="settings-scroll-box">
                        <div class="settings-section-title">
                            â±ï¸ íƒ€ì„ë¼ì¸ ì‹œê°„ ë²”ìœ„
                        </div>
                        <div class="settings-help" style="margin-bottom: 16px;">
                            IP ë¹„êµ íƒ€ì„ë¼ì¸ ì°¨íŠ¸ì— í‘œì‹œí•  ì‹œê°„ ë²”ìœ„ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
                        </div>
                        <div class="time-range-radio-group" id="timeRangeRadioGroup">
                            <label class="time-range-radio">
                                <input type="radio" name="timeRange" value="60">
                                <span class="radio-label">1ë¶„</span>
                            </label>
                            <label class="time-range-radio">
                                <input type="radio" name="timeRange" value="300">
                                <span class="radio-label">5ë¶„</span>
                            </label>
                            <label class="time-range-radio">
                                <input type="radio" name="timeRange" value="600">
                                <span class="radio-label">10ë¶„</span>
                            </label>
                            <label class="time-range-radio">
                                <input type="radio" name="timeRange" value="1800">
                                <span class="radio-label">30ë¶„</span>
                            </label>
                            <label class="time-range-radio">
                                <input type="radio" name="timeRange" value="3600">
                                <span class="radio-label">1ì‹œê°„</span>
                            </label>
                            <label class="time-range-radio">
                                <input type="radio" name="timeRange" value="10800">
                                <span class="radio-label">3ì‹œê°„</span>
                            </label>
                            <label class="time-range-radio">
                                <input type="radio" name="timeRange" value="18000">
                                <span class="radio-label">5ì‹œê°„</span>
                            </label>
                            <label class="time-range-radio">
                                <input type="radio" name="timeRange" value="43200">
                                <span class="radio-label">12ì‹œê°„</span>
                            </label>
                            <label class="time-range-radio">
                                <input type="radio" name="timeRange" value="86400">
                                <span class="radio-label">24ì‹œê°„</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Tab 3: ê·¸ë£¹ë³„ ì„¤ì • -->
                <div class="settings-tab-content" id="settings-thresholds">
                    <div class="settings-scroll-box">
                        <!-- Content -->
                        <div id="thresholdContent">
                            <div class="settings-section">
                                <div class="settings-section-title">
                                    âš¡ ê¸°ë³¸ ì„¤ì •
                                </div>
                                <div class="settings-form-group">
                                    <label class="settings-label">ë¯¸ì‘ë‹µ ê¸°ë¡ ê¸°ì¤€ ì‹œê°„ (ì´ˆ)</label>
                                    <div class="threshold-input-group">
                                        <input type="number" class="settings-input" id="defaultThreshold" 
                                               value="300" min="30" max="3600" step="10"
                                               oninput="syncThresholdSlider('defaultThreshold')">
                                        <input type="range" class="threshold-slider" id="defaultThreshold_slider"
                                               value="300" min="30" max="600" step="10"
                                               oninput="syncThresholdInput('defaultThreshold')">
                                    </div>
                                    <div class="settings-help">
                                        IPê°€ ì´ ì‹œê°„(ì´ˆ) ë™ì•ˆ ì‘ë‹µì´ ì—†ìœ¼ë©´ ë¯¸ì‘ë‹µìœ¼ë¡œ ê¸°ë¡ë©ë‹ˆë‹¤. (ê¸°ë³¸: 300ì´ˆ = 5ë¶„)
                                    </div>
                                </div>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">
                                    ğŸ“Š ê·¸ë£¹ë³„ ì»¤ìŠ¤í…€ ì„¤ì •
                                </div>
                                <table class="threshold-table">
                                    <thead>
                                        <tr>
                                            <th>ê·¸ë£¹</th>
                                            <th>ê¸°ì¤€ ì‹œê°„ (ì´ˆ)</th>
                                            <th>ìŠ¬ë¼ì´ë”</th>
                                            <th>ì„¤ëª…</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>ğŸ–¥ï¸ ì„œë²„</td>
                                            <td><input type="number" id="thresh_ì„œë²„" value="180" min="30" max="3600" step="10" oninput="syncThresholdSlider('thresh_ì„œë²„')"></td>
                                            <td><input type="range" id="thresh_ì„œë²„_slider" value="180" min="30" max="600" step="10" oninput="syncThresholdInput('thresh_ì„œë²„')"></td>
                                            <td class="settings-help">ì„œë²„: 3ë¶„ (180ì´ˆ)</td>
                                        </tr>
                                        <tr>
                                            <td>ğŸŒ ë„¤íŠ¸ì›Œí¬</td>
                                            <td><input type="number" id="thresh_ë„¤íŠ¸ì›Œí¬" value="300" min="30" max="3600" step="10" oninput="syncThresholdSlider('thresh_ë„¤íŠ¸ì›Œí¬')"></td>
                                            <td><input type="range" id="thresh_ë„¤íŠ¸ì›Œí¬_slider" value="300" min="30" max="600" step="10" oninput="syncThresholdInput('thresh_ë„¤íŠ¸ì›Œí¬')"></td>
                                            <td class="settings-help">ë„¤íŠ¸ì›Œí¬: 5ë¶„ (300ì´ˆ)</td>
                                        </tr>
                                        <tr>
                                            <td>ğŸ›¡ï¸ ë°©í™”ë²½</td>
                                            <td><input type="number" id="thresh_ë°©í™”ë²½" value="120" min="30" max="3600" step="10" oninput="syncThresholdSlider('thresh_ë°©í™”ë²½')"></td>
                                            <td><input type="range" id="thresh_ë°©í™”ë²½_slider" value="120" min="30" max="600" step="10" oninput="syncThresholdInput('thresh_ë°©í™”ë²½')"></td>
                                            <td class="settings-help">ë°©í™”ë²½: 2ë¶„ (120ì´ˆ)</td>
                                        </tr>
                                        <tr>
                                            <td>ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤</td>
                                            <td><input type="number" id="thresh_ë°ì´í„°ë² ì´ìŠ¤" value="180" min="30" max="3600" step="10" oninput="syncThresholdSlider('thresh_ë°ì´í„°ë² ì´ìŠ¤')"></td>
                                            <td><input type="range" id="thresh_ë°ì´í„°ë² ì´ìŠ¤_slider" value="180" min="30" max="600" step="10" oninput="syncThresholdInput('thresh_ë°ì´í„°ë² ì´ìŠ¤')"></td>
                                            <td class="settings-help">ë°ì´í„°ë² ì´ìŠ¤: 3ë¶„ (180ì´ˆ)</td>
                                        </tr>
                                        <tr>
                                            <td>ğŸŒ ì›¹ì„œë²„</td>
                                            <td><input type="number" id="thresh_ì›¹ì„œë²„" value="240" min="30" max="3600" step="10" oninput="syncThresholdSlider('thresh_ì›¹ì„œë²„')"></td>
                                            <td><input type="range" id="thresh_ì›¹ì„œë²„_slider" value="240" min="30" max="600" step="10" oninput="syncThresholdInput('thresh_ì›¹ì„œë²„')"></td>
                                            <td class="settings-help">ì›¹ì„œë²„: 4ë¶„ (240ì´ˆ)</td>
                                        </tr>
                                        <tr>
                                            <td>ğŸ“¦ ìŠ¤í† ë¦¬ì§€</td>
                                            <td><input type="number" id="thresh_ìŠ¤í† ë¦¬ì§€" value="300" min="30" max="3600" step="10" oninput="syncThresholdSlider('thresh_ìŠ¤í† ë¦¬ì§€')"></td>
                                            <td><input type="range" id="thresh_ìŠ¤í† ë¦¬ì§€_slider" value="300" min="30" max="600" step="10" oninput="syncThresholdInput('thresh_ìŠ¤í† ë¦¬ì§€')"></td>
                                            <td class="settings-help">ìŠ¤í† ë¦¬ì§€: 5ë¶„ (300ì´ˆ)</td>
                                        </tr>
                                        <tr>
                                            <td>ğŸ”§ ê¸°íƒ€</td>
                                            <td><input type="number" id="thresh_ê¸°íƒ€" value="300" min="30" max="3600" step="10" oninput="syncThresholdSlider('thresh_ê¸°íƒ€')"></td>
                                            <td><input type="range" id="thresh_ê¸°íƒ€_slider" value="300" min="30" max="600" step="10" oninput="syncThresholdInput('thresh_ê¸°íƒ€')"></td>
                                            <td class="settings-help">ê¸°íƒ€: 5ë¶„ (300ì´ˆ)</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tab 4: IP ê·¸ë£¹ ê´€ë¦¬ -->
                <div class="settings-tab-content" id="settings-ipgroups">
                    <div class="settings-scroll-box">
                        <!-- Empty State Guide -->
                        <div id="ipgroupEmptyState" class="empty-state" style="display: block;">
                            <div style="font-size: 48px; margin-bottom: 16px;">ğŸ·ï¸</div>
                            <h3 style="font-size: 20px; margin-bottom: 12px; color: var(--text-primary);">IP ê·¸ë£¹ ë° ìš°ì„ ìˆœìœ„ ê´€ë¦¬</h3>
                            <p style="font-size: 14px; line-height: 1.6; max-width: 500px; margin: 0 auto;">
                                í™•ì¸ ì¤‘ì¸ IPë¥¼ ê·¸ë£¹ìœ¼ë¡œ ë¶„ë¥˜í•˜ê³  ìš°ì„ ìˆœìœ„ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
                                ìš°ì„ ìˆœìœ„ 1ì´ ê°€ì¥ ë†’ìŠµë‹ˆë‹¤.<br><br>
                                <strong>ê·¸ë£¹ ì¢…ë¥˜:</strong> ì„œë²„, ë„¤íŠ¸ì›Œí¬, ë°©í™”ë²½, ë°ì´í„°ë² ì´ìŠ¤, ì›¹ì„œë²„, ìŠ¤í† ë¦¬ì§€, ê¸°íƒ€
                            </p>
                        </div>
                        
                        <!-- Content -->
                        <div id="ipgroupContent" style="display: none;">
                            <div class="settings-section">
                                <div class="settings-section-title">
                                    ğŸ·ï¸ IPë³„ ê·¸ë£¹ ë° ìš°ì„ ìˆœìœ„
                                </div>
                                <div class="settings-help" style="margin-bottom: 16px;">
                                    ê° IPì˜ ê·¸ë£¹ê³¼ ìš°ì„ ìˆœìœ„ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ìš°ì„ ìˆœìœ„ 1ì´ ê°€ì¥ ë†’ìŠµë‹ˆë‹¤.
                                </div>
                                <table class="ip-config-table" id="ipConfigTable">
                                    <thead>
                                        <tr>
                                            <th>IP ì£¼ì†Œ</th>
                                            <th>ì´ë¦„</th>
                                            <th>ê·¸ë£¹</th>
                                            <th>ìš°ì„ ìˆœìœ„ (1-5)</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ipConfigTableBody">
                                        <!-- Dynamically populated -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                    </div><!-- settings-tab-container -->
                    
                    <!-- ê³µí†µ ì €ì¥ ë²„íŠ¼ -->
                    <div class="settings-footer">
                        <button class="btn btn-primary" id="saveAllSettings">ğŸ’¾ ì €ì¥</button>
                    </div>
                </div><!-- modal-content -->
            </div><!-- modal -->

            <!-- Minimized Cards Area -->
            <div id="minimizedCardsArea" class="minimized-cards-area" style="display: none;">
                <div class="minimized-area-header">
                    <span class="minimized-area-title">ğŸ“¦ ìµœì†Œí™”ëœ IP</span>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span class="minimized-count" id="minimizedCount">0</span>
                        <button class="minimize-btn" id="minimizedAreaMinimizeBtn" title="ìµœì†Œí™”ëœ IP ì˜ì—­ ìµœì†Œí™”/í™•ëŒ€">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="18 15 12 9 6 15"></polyline>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="collapsible-content" id="minimizedAreaContent">
                    <div id="minimizedCardsContainer" class="minimized-cards-container"></div>
                </div>
            </div>

            <!-- IP Cards -->
            <div id="ipCardsContainer" class="ip-grid"></div>
        </div>

        <!-- Notifications Tab -->
        <div class="tab-content" id="notifications">
            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">ì „ì²´ ì•Œë¦¼</div>
                    <div class="stat-value" id="notifTotalCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">íƒ€ì„ì•„ì›ƒ</div>
                    <div class="stat-value" style="color: var(--error);" id="notifTimeoutCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ë³µêµ¬</div>
                    <div class="stat-value" style="color: var(--success);" id="notifRecoveryCount">0</div>
                </div>
            </div>

            <!-- Notification Log -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">ì•Œë¦¼ ê¸°ë¡</div>
                </div>
                
                <div class="filter-bar">
                    <button class="filter-btn active" data-filter="all">ì „ì²´</button>
                    <button class="filter-btn" data-filter="timeout">íƒ€ì„ì•„ì›ƒë§Œ</button>
                    <button class="filter-btn" data-filter="recovery">ë³µêµ¬ë§Œ</button>
                </div>

                <div class="notification-list" id="notificationList">
                    <div class="loading">ì•Œë¦¼ ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div class="modal" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <div>
                    <h2 class="modal-title" id="modalTitle">IP ìƒì„¸ ì •ë³´</h2>
                    <p id="modalSubtitle" style="color: var(--text-secondary); font-size: 14px; margin-top: 4px;"></p>
                </div>
                <button class="modal-close" id="modalClose">Ã—</button>
            </div>
            <div class="modal-body">
                <!-- Stats -->
                <div class="modal-stats">
                    <div class="modal-stat-card">
                        <div class="modal-stat-label">í˜„ì¬ ì§€ì—°ì‹œê°„</div>
                        <div class="modal-stat-value" id="modalLatency">0 ms</div>
                    </div>
                    <div class="modal-stat-card">
                        <div class="modal-stat-label">ìµœì†Œ</div>
                        <div class="modal-stat-value" style="color: var(--success);" id="modalMin">0 ms</div>
                    </div>
                    <div class="modal-stat-card">
                        <div class="modal-stat-label">í‰ê· </div>
                        <div class="modal-stat-value" style="color: var(--info);" id="modalAvg">0 ms</div>
                    </div>
                    <div class="modal-stat-card">
                        <div class="modal-stat-label">ìµœëŒ€</div>
                        <div class="modal-stat-value" style="color: var(--error);" id="modalMax">0 ms</div>
                    </div>
                    <div class="modal-stat-card">
                        <div class="modal-stat-label">íŒ¨í‚· ì†ì‹¤ë¥ </div>
                        <div class="modal-stat-value" id="modalLoss">0%</div>
                    </div>
                    <div class="modal-stat-card">
                        <div class="modal-stat-label">ìƒíƒœ</div>
                        <div class="modal-stat-value" id="modalStatus">ì˜¤í”„ë¼ì¸</div>
                    </div>
                </div>

                <!-- Chart -->
                <div class="modal-chart-container">
                    <canvas id="modalChart"></canvas>
                </div>

                <!-- Details -->
                <div class="modal-details">
                    <div class="modal-detail-item">
                        <div class="modal-detail-label">ì´ ìš”ì²­</div>
                        <div class="modal-detail-value" id="modalTotal">0</div>
                    </div>
                    <div class="modal-detail-item">
                        <div class="modal-detail-label">ì„±ê³µ</div>
                        <div class="modal-detail-value" style="color: var(--success);" id="modalSuccess">0</div>
                    </div>
                    <div class="modal-detail-item">
                        <div class="modal-detail-label">ì‹¤íŒ¨</div>
                        <div class="modal-detail-value" style="color: var(--error);" id="modalFailed">0</div>
                    </div>
                    <div class="modal-detail-item">
                        <div class="modal-detail-label">ë§ˆì§€ë§‰ ì‘ë‹µ ì‹œê°„</div>
                        <div class="modal-detail-value" id="modalLastResponse">--:--:--</div>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
    <script>
        // Global State
        let isRunning = true;
        let updateInterval;
        let timeInterval;
        // comparisonChart - timeline.jsì—ì„œ ê´€ë¦¬
        let ipCharts = {};
        let currentData = null;
        let draggedElement = null;
        let draggedIndex = null;
        let startTime = Date.now();
        let pausedElapsed = 0;
        let pausedTime = 0;
        let modalChart = null;
        let currentModalTarget = null;
        
        // visibleIPs - timeline.jsì—ì„œ ê´€ë¦¬
        // extendedHistory - timeline.jsì—ì„œ ê´€ë¦¬
        // selectedTimeRange - timeline.jsì—ì„œ ê´€ë¦¬
        // MAX_HISTORY_POINTS - timeline.jsì—ì„œ ê´€ë¦¬
        // brightColors - timeline.jsì—ì„œ ê´€ë¦¬
        
        // Notification State
        let allNotifications = [];
        let currentFilter = 'all';
        let allOutages = [];
        let currentOutageFilter = {status: 'all', group: 'all'};

        // DOMì´ ì¤€ë¹„ëœ í›„ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM ë¡œë“œ ì™„ë£Œ');
            
            // Initialize event listeners
            initializeEventListeners();
            
            // Initialize timeline (from timeline.js)
            initTimelineEvents();
            loadTimelineRange();
            
            // Initialize charts and data
            initComparisonChart();
            loadData();
            startUpdates();
            
            // Start time updates
            updateTime();
            timeInterval = setInterval(updateTime, 1000);
        });

        // ë¸Œë¼ìš°ì € ì¢…ë£Œ ê°ì§€
        let isRefreshing = false;
        
        window.addEventListener('beforeunload', function(e) {
            // ìƒˆë¡œê³ ì¹¨ì¸ì§€ í™•ì¸
            if (performance.navigation.type === 1) {
                isRefreshing = true;
                return;
            }
            
            // ë¸Œë¼ìš°ì € ë‹«ê¸° ì‹œ ì„œë²„ ì¢…ë£Œ ìš”ì²­
            if (!isRefreshing) {
                navigator.sendBeacon('/shutdown');
            }
        });

        function initializeEventListeners() {
            // Timeline Range Radio Buttons - settings.jsë¡œ ì´ë™ë¨
            // Timeline Minimize Button - timeline.jsì˜ initTimelineEvents()ë¡œ ì´ë™ë¨

            // Minimized Area Minimize Button
            const minimizedAreaMinimizeBtn = document.getElementById('minimizedAreaMinimizeBtn');
            const minimizedAreaContent = document.getElementById('minimizedAreaContent');
            if (minimizedAreaMinimizeBtn && minimizedAreaContent) {
                minimizedAreaMinimizeBtn.addEventListener('click', () => {
                    const isCollapsed = minimizedAreaContent.classList.toggle('collapsed');
                    minimizedAreaMinimizeBtn.classList.toggle('minimized', isCollapsed);
                    
                    // ìƒíƒœ ì €ì¥
                    localStorage.setItem('minimizedAreaCollapsed', isCollapsed ? '1' : '0');
                });
                
                // ì €ì¥ëœ ìƒíƒœ ë³µì›
                if (localStorage.getItem('minimizedAreaCollapsed') === '1') {
                    minimizedAreaContent.classList.add('collapsed');
                    minimizedAreaMinimizeBtn.classList.add('minimized');
                }
            }

            // Control Buttons
            const toggleBtn = document.getElementById('toggleBtn');
            if (toggleBtn) {
                toggleBtn.addEventListener('click', function() {
                    isRunning = !isRunning;
                    toggleBtn.textContent = isRunning ? 'ì¼ì‹œì •ì§€' : 'ì‹œì‘';
                    toggleBtn.className = isRunning ? 'btn btn-primary' : 'btn btn-success';
                    
                    if (isRunning) {
                        startUpdates();
                        if (pausedTime > 0) {
                            const pauseDuration = Date.now() - pausedTime;
                            startTime += pauseDuration;
                            pausedTime = 0;
                        }
                    } else {
                        stopUpdates();
                        pausedTime = Date.now();
                    }
                });
            }

            const refreshBtn = document.getElementById('refreshBtn');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', async function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const originalText = refreshBtn.textContent;
                    
                    try {
                        refreshBtn.textContent = 'ìƒˆë¡œê³ ì¹¨ ì¤‘...';
                        refreshBtn.disabled = true;
                        
                        startTime = Date.now();
                        pausedTime = 0;
                        pausedElapsed = 0;
                        updateTime();
                        
                        // íƒ€ì„ë¼ì¸ ì°¨íŠ¸ ë¦¬ì…‹ (timeline.js)
                        resetComparisonChart();
                        
                        Object.keys(ipCharts).forEach(key => {
                            if (ipCharts[key]) {
                                ipCharts[key].destroy();
                            }
                        });
                        ipCharts = {};
                        
                        const ipCardsContainer = document.getElementById('ipCardsContainer');
                        if (ipCardsContainer) {
                            ipCardsContainer.innerHTML = '';
                        }
                        
                        const minimizedCardsContainer = document.getElementById('minimizedCardsContainer');
                        if (minimizedCardsContainer) {
                            minimizedCardsContainer.innerHTML = '';
                        }
                        const minimizedCardsArea = document.getElementById('minimizedCardsArea');
                        if (minimizedCardsArea) {
                            minimizedCardsArea.style.display = 'none';
                        }
                        
                        await loadData();
                        
                        const notificationTab = document.getElementById('notifications');
                        if (notificationTab && notificationTab.classList.contains('active')) {
                            await loadNotifications();
                        }
                    } catch (error) {
                        console.error('ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨:', error);
                    } finally {
                        refreshBtn.textContent = originalText;
                        refreshBtn.disabled = false;
                    }
                });
            }

            // Sort Buttons
            const sortByName = document.getElementById('sortByName');
            const sortByLatency = document.getElementById('sortByLatency');
            const sortByStatus = document.getElementById('sortByStatus');
            
            if (sortByName) sortByName.addEventListener('click', () => sortIPCards('name'));
            if (sortByLatency) sortByLatency.addEventListener('click', () => sortIPCards('latency'));
            if (sortByStatus) sortByStatus.addEventListener('click', () => sortIPCards('status'));

            // Modal Buttons
            const modalCloseBtn = document.getElementById('modalClose');
            const detailModal = document.getElementById('detailModal');
            
            if (modalCloseBtn) {
                modalCloseBtn.addEventListener('click', closeDetailModal);
            }
            
            if (detailModal) {
                detailModal.addEventListener('click', (e) => {
                    if (e.target.id === 'detailModal') {
                        closeDetailModal();
                    }
                });
            }

            // Tab Buttons
            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    btn.classList.add('active');
                    const targetId = btn.getAttribute('data-tab');
                    const targetContent = document.getElementById(targetId);
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                    
                    if (targetId === 'notifications') {
                        loadNotifications();
                    } else if (targetId === 'outages') {
                        loadOutages();
                    }
                });
            });

            // Notification Filter Buttons
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFilter = btn.getAttribute('data-filter');
                    renderNotifications();
                });
            });

            // Chart Settings Modal - settings.jsë¡œ ì´ë™ë¨
        }

        // Load saved header state

        // Save/Load visible IPs state - settings.jsë¡œ ì´ë™ë¨

        // Save minimized state
        function saveMinimizedState() {
            const minimizedCards = document.querySelectorAll('.ip-card.minimized');
            const minimizedIndices = Array.from(minimizedCards).map(card => card.dataset.index);
            localStorage.setItem('minimizedCards', JSON.stringify(minimizedIndices));
            console.log('ìµœì†Œí™” ìƒíƒœ ì €ì¥:', minimizedIndices);
        }

        // Load minimized state
        function loadMinimizedState() {
            const saved = localStorage.getItem('minimizedCards');
            if (saved) {
                try {
                    const minimizedIndices = JSON.parse(saved);
                    console.log('ìµœì†Œí™” ìƒíƒœ ë¡œë“œ:', minimizedIndices);
                    
                    setTimeout(() => {
                        minimizedIndices.forEach(index => {
                            const card = document.getElementById(`ip-card-${index}`);
                            if (card && !card.classList.contains('minimized')) {
                                toggleMinimize(parseInt(index));
                            }
                        });
                    }, 100);
                } catch (e) {
                    console.error('ìµœì†Œí™” ìƒíƒœ ë¡œë“œ ì‹¤íŒ¨:', e);
                }
            }
        }

        // Time Update Functions
        function updateTime() {
            const now = new Date();
            
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            document.getElementById('currentTime').textContent = `${hours}:${minutes}:${seconds}`;
            
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            document.getElementById('currentDate').textContent = `${year}-${month}-${day}`;
            
            let elapsed;
            if (!isRunning && pausedTime > 0) {
                elapsed = Math.floor((pausedTime - startTime) / 1000);
            } else {
                elapsed = Math.floor((Date.now() - startTime) / 1000);
            }
            
            const uptimeHours = Math.floor(elapsed / 3600);
            const uptimeMinutes = Math.floor((elapsed % 3600) / 60);
            const uptimeSeconds = elapsed % 60;
            document.getElementById('uptime').textContent = 
                `${String(uptimeHours).padStart(2, '0')}:${String(uptimeMinutes).padStart(2, '0')}:${String(uptimeSeconds).padStart(2, '0')}`;
        }

        // initComparisonChart - timeline.jsë¡œ ì´ë™ë¨

        function createIPChart(canvasId, index) {
            const ctx = document.getElementById(canvasId);
            const color = brightColors[index % brightColors.length];
            
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array(60).fill(''),
                    datasets: [{
                        label: 'Latency (ms)',
                        data: [],
                        borderColor: color,
                        backgroundColor: color + '30',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#3a3f5c' },
                            ticks: { color: '#b0b3b8' }
                        },
                        x: {
                            display: false
                        }
                    }
                }
            });
        }

        // Load Data
        async function loadData() {
            try {
                const response = await fetch('/data/ping_data.json?t=' + Date.now());
                const data = await response.json();
                currentData = data;
                updateUI(data);
            } catch (error) {
                console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // Update UI
        function updateUI(data) {
            if (!data || !data.targets) return;

            // ì €ì¥ëœ í•„í„° ìƒíƒœ ë¡œë“œ ë˜ëŠ” ì´ˆê¸°í™”
            if (visibleIPs.size === 0) {
                const loaded = loadVisibleIPsState();
                if (!loaded) {
                    data.targets.forEach((_, index) => visibleIPs.add(index));
                }
            }

            // Update global stats
            const onlineCount = data.targets.filter(t => t.online).length;
            const offlineCount = data.targets.length - onlineCount;
            const avgLatency = Math.round(
                data.targets.reduce((sum, t) => sum + (t.online ? t.latency : 0), 0) / 
                (onlineCount || 1)
            );

            document.getElementById('totalIPs').textContent = data.targets.length;
            document.getElementById('onlineCount').textContent = onlineCount;
            document.getElementById('offlineCount').textContent = offlineCount;
            document.getElementById('avgLatency').textContent = avgLatency + ' ms';

            // Update comparison chart
            updateComparisonChart(data.targets);

            // Update IP cards
            updateIPCards(data.targets);
            
            // Load minimized state (only first time)
            if (Object.keys(ipCharts).length === data.targets.length) {
                loadMinimizedState();
            }
            
            // Update modal if open
            updateModalIfOpen();
        }

        // updateComparisonChart - timeline.jsë¡œ ì´ë™ë¨
        // generateTimeLabels - timeline.jsë¡œ ì´ë™ë¨
        // getDisplayData - timeline.jsë¡œ ì´ë™ë¨

        // Chart Settings Functions - settings.jsë¡œ ì´ë™ë¨

        // Update IP Cards
        function updateIPCards(targets) {
            const container = document.getElementById('ipCardsContainer');
            
            targets.forEach((target, index) => {
                let card = document.getElementById(`ip-card-${index}`);
                
                if (!card) {
                    card = createIPCard(target, index);
                    container.appendChild(card);
                    ipCharts[index] = createIPChart(`chart-${index}`, index);
                }
                
                updateIPCard(card, target, index);
            });
        }

        // Create IP Card
        function createIPCard(target, index) {
            const card = document.createElement('div');
            card.id = `ip-card-${index}`;
            card.className = 'ip-card';
            card.draggable = true;
            card.dataset.index = index;
            
            card.addEventListener('dragstart', handleDragStart);
            card.addEventListener('dragover', handleDragOver);
            card.addEventListener('drop', handleDrop);
            card.addEventListener('dragend', handleDragEnd);
            
            card.innerHTML = `
                <div class="ip-header">
                    <div>
                        <div class="ip-name">${target.name}</div>
                        <div class="ip-address">${target.ip}</div>
                    </div>
                    <div class="card-actions">
                        <button class="card-action-btn card-minimize-btn" onclick="toggleMinimize(${index})" title="ìµœì†Œí™”">âˆ’</button>
                        <button class="card-action-btn card-restore-btn" onclick="toggleMinimize(${index})" title="ë³µì›">+</button>
                        <button class="card-action-btn card-expand-btn" onclick="openDetailModal(${index})" title="ìƒì„¸ë³´ê¸°">âŠ•</button>
                    </div>
                </div>
                <span class="status-badge" id="status-${index}">ì˜¤í”„ë¼ì¸</span>
                <div class="chart-container">
                    <canvas id="chart-${index}"></canvas>
                </div>
                <div class="stats-row">
                    <div class="stat-item">
                        <div class="stat-item-label">ì§€ì—°ì‹œê°„</div>
                        <div class="stat-item-value" id="latency-${index}">0 ms</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-item-label">ìµœì†Œ</div>
                        <div class="stat-item-value" id="min-${index}">0 ms</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-item-label">í‰ê· </div>
                        <div class="stat-item-value" id="avg-${index}">0 ms</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-item-label">ìµœëŒ€</div>
                        <div class="stat-item-value" id="max-${index}">0 ms</div>
                    </div>
                </div>
                <div class="packet-bars" id="packets-${index}"></div>
            `;
            return card;
        }

        // Drag & Drop Handlers
        function handleDragStart(e) {
            draggedElement = this;
            draggedIndex = parseInt(this.dataset.index);
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            
            if (draggedElement !== this) {
                const container = document.getElementById('ipCardsContainer');
                const allCards = [...container.children];
                const draggedPos = allCards.indexOf(draggedElement);
                const targetPos = allCards.indexOf(this);
                
                if (draggedPos < targetPos) {
                    this.parentNode.insertBefore(draggedElement, this.nextSibling);
                } else {
                    this.parentNode.insertBefore(draggedElement, this);
                }
            }
            
            return false;
        }

        function handleDragEnd() {
            this.classList.remove('dragging');
            draggedElement = null;
            draggedIndex = null;
        }

        // Sort Functions
        function sortIPCards(sortBy) {
            if (!currentData || !currentData.targets) return;
            
            const container = document.getElementById('ipCardsContainer');
            const cards = [...container.children];
            
            const targets = currentData.targets.map((target, index) => ({
                target,
                index,
                card: cards[index]
            }));
            
            targets.sort((a, b) => {
                switch(sortBy) {
                    case 'name':
                        return a.target.name.localeCompare(b.target.name);
                    case 'latency':
                        return b.target.latency - a.target.latency;
                    case 'status':
                        return b.target.online - a.target.online;
                    default:
                        return 0;
                }
            });
            
            container.innerHTML = '';
            targets.forEach(item => {
                container.appendChild(item.card);
            });
        }

        // Toggle Minimize
        function toggleMinimize(index) {
            const card = document.getElementById(`ip-card-${index}`);
            
            if (!card) return;
            
            const isMinimized = card.classList.contains('minimized');
            const ipCardsContainer = document.getElementById('ipCardsContainer');
            const minimizedCardsContainer = document.getElementById('minimizedCardsContainer');
            const minimizedCardsArea = document.getElementById('minimizedCardsArea');
            
            if (isMinimized) {
                card.classList.remove('minimized');
                card.draggable = true;
                ipCardsContainer.appendChild(card);
            } else {
                card.classList.add('minimized');
                card.draggable = false;
                minimizedCardsContainer.appendChild(card);
            }
            
            updateMinimizedArea();
            saveMinimizedState();
        }

        // Update Minimized Area
        function updateMinimizedArea() {
            const minimizedCardsContainer = document.getElementById('minimizedCardsContainer');
            const minimizedCardsArea = document.getElementById('minimizedCardsArea');
            const minimizedCount = document.getElementById('minimizedCount');
            
            const count = minimizedCardsContainer.children.length;
            
            if (count > 0) {
                minimizedCardsArea.style.display = 'block';
            } else {
                minimizedCardsArea.style.display = 'none';
            }
            
            minimizedCount.textContent = count;
        }

        // Open Detail Modal
        function openDetailModal(index) {
            if (!currentData || !currentData.targets[index]) return;
            
            const target = currentData.targets[index];
            currentModalTarget = index;
            
            document.getElementById('modalTitle').textContent = target.name;
            document.getElementById('modalSubtitle').textContent = target.ip;
            
            document.getElementById('modalLatency').textContent = target.latency + ' ms';
            document.getElementById('modalMin').textContent = target.min + ' ms';
            document.getElementById('modalAvg').textContent = Math.round(target.avg) + ' ms';
            document.getElementById('modalMax').textContent = target.max + ' ms';
            
            const lossRate = target.total > 0 ? ((target.failed / target.total) * 100).toFixed(1) : 0;
            document.getElementById('modalLoss').textContent = lossRate + '%';
            document.getElementById('modalStatus').textContent = target.online ? 'ì˜¨ë¼ì¸' : 'ì˜¤í”„ë¼ì¸';
            document.getElementById('modalStatus').style.color = target.online ? 'var(--success)' : 'var(--error)';
            
            document.getElementById('modalTotal').textContent = target.total;
            document.getElementById('modalSuccess').textContent = target.total - target.failed;
            document.getElementById('modalFailed').textContent = target.failed;
            
            const now = new Date();
            const timeStr = `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}`;
            document.getElementById('modalLastResponse').textContent = target.online ? timeStr : 'ì‘ë‹µ ì—†ìŒ';
            
            createModalChart(target, index);
            
            document.getElementById('detailModal').classList.add('active');
            document.body.style.overflow = 'hidden';  // ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€
        }

        // Close Detail Modal
        function closeDetailModal() {
            document.getElementById('detailModal').classList.remove('active');
            document.body.style.overflow = '';  // ë°°ê²½ ìŠ¤í¬ë¡¤ ë³µì›
            if (modalChart) {
                modalChart.destroy();
                modalChart = null;
            }
            currentModalTarget = null;
        }

        // Create Modal Chart
        function createModalChart(target, index) {
            if (modalChart) {
                modalChart.destroy();
            }
            
            const ctx = document.getElementById('modalChart');
            const color = brightColors[index % brightColors.length];
            
            const now = new Date();
            const labels = Array(60).fill('').map((_, i) => {
                const time = new Date(now.getTime() - (59 - i) * 1000);
                return `${String(time.getHours()).padStart(2, '0')}:${String(time.getMinutes()).padStart(2, '0')}:${String(time.getSeconds()).padStart(2, '0')}`;
            });
            
            modalChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ì§€ì—°ì‹œê°„ (ms)',
                        data: target.history,
                        borderColor: color,
                        backgroundColor: color + '30',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 3,
                        pointRadius: 1,
                        pointHoverRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: {
                            display: true,
                            labels: { 
                                color: '#e4e6eb', 
                                font: { size: 12 },
                                padding: 10
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: { size: 12 },
                            bodyFont: { size: 11 },
                            padding: 8
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#3a3f5c' },
                            ticks: { 
                                color: '#b0b3b8',
                                font: { size: 11 }
                            }
                        },
                        x: {
                            grid: { color: '#3a3f5c' },
                            ticks: { 
                                color: '#b0b3b8',
                                font: { size: 9 },
                                maxRotation: 45,
                                minRotation: 45,
                                autoSkip: true,
                                maxTicksLimit: 12
                            }
                        }
                    }
                }
            });
        }

        // Update Modal if Open
        function updateModalIfOpen() {
            if (currentModalTarget !== null && currentData && currentData.targets[currentModalTarget]) {
                const target = currentData.targets[currentModalTarget];
                
                document.getElementById('modalLatency').textContent = target.latency + ' ms';
                document.getElementById('modalMin').textContent = target.min + ' ms';
                document.getElementById('modalAvg').textContent = Math.round(target.avg) + ' ms';
                document.getElementById('modalMax').textContent = target.max + ' ms';
                
                const lossRate = target.total > 0 ? ((target.failed / target.total) * 100).toFixed(1) : 0;
                document.getElementById('modalLoss').textContent = lossRate + '%';
                document.getElementById('modalStatus').textContent = target.online ? 'ì˜¨ë¼ì¸' : 'ì˜¤í”„ë¼ì¸';
                document.getElementById('modalStatus').style.color = target.online ? 'var(--success)' : 'var(--error)';
                
                document.getElementById('modalTotal').textContent = target.total;
                document.getElementById('modalSuccess').textContent = target.total - target.failed;
                document.getElementById('modalFailed').textContent = target.failed;
                
                if (modalChart) {
                    const now = new Date();
                    const labels = Array(60).fill('').map((_, i) => {
                        const time = new Date(now.getTime() - (59 - i) * 1000);
                        return `${String(time.getHours()).padStart(2, '0')}:${String(time.getMinutes()).padStart(2, '0')}:${String(time.getSeconds()).padStart(2, '0')}`;
                    });
                    
                    modalChart.data.labels = labels;
                    modalChart.data.datasets[0].data = target.history;
                    modalChart.update();
                }
                
                const now = new Date();
                const timeStr = `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}`;
                document.getElementById('modalLastResponse').textContent = target.online ? timeStr : 'ì‘ë‹µ ì—†ìŒ';
            }
        }

        // Update IP Card
        function updateIPCard(card, target, index) {
            const statusBadge = card.querySelector(`#status-${index}`);
            if (statusBadge) {
                statusBadge.textContent = target.online ? 'ì˜¨ë¼ì¸' : 'ì˜¤í”„ë¼ì¸';
                statusBadge.className = target.online ? 'status-badge status-online' : 'status-badge status-offline';
            }

            const latencyEl = document.getElementById(`latency-${index}`);
            if (latencyEl) latencyEl.textContent = target.latency + ' ms';
            
            const minEl = document.getElementById(`min-${index}`);
            if (minEl) minEl.textContent = target.min + ' ms';
            
            const avgEl = document.getElementById(`avg-${index}`);
            if (avgEl) avgEl.textContent = Math.round(target.avg) + ' ms';
            
            const maxEl = document.getElementById(`max-${index}`);
            if (maxEl) maxEl.textContent = target.max + ' ms';

            if (ipCharts[index] && !card.classList.contains('minimized')) {
                ipCharts[index].data.datasets[0].data = target.history;
                ipCharts[index].update();
            }

            const packetsContainer = document.getElementById(`packets-${index}`);
            if (packetsContainer) {
                packetsContainer.innerHTML = target.history.map(latency => {
                    const className = latency > 0 ? 'packet-bar packet-success' : 'packet-bar packet-fail';
                    return `<div class="${className}"></div>`;
                }).join('');
            }
        }

        // Load Notifications
        async function loadNotifications() {
            try {
                const response = await fetch('/data/notification_log.json?t=' + Date.now());
                if (!response.ok) {
                    showEmptyNotifications();
                    return;
                }
                
                const logs = await response.json();
                allNotifications = logs.reverse();
                
                updateNotificationStats();
                renderNotifications();
            } catch (error) {
                console.error('ì•Œë¦¼ ë¡œë“œ ì‹¤íŒ¨:', error);
                showEmptyNotifications();
            }
        }

        // Update Notification Stats
        function updateNotificationStats() {
            const total = allNotifications.length;
            const timeouts = allNotifications.filter(n => n.type === 'timeout').length;
            const recoveries = allNotifications.filter(n => n.type === 'recovery').length;

            document.getElementById('notifTotalCount').textContent = total;
            document.getElementById('notifTimeoutCount').textContent = timeouts;
            document.getElementById('notifRecoveryCount').textContent = recoveries;
        }

        // Render Notifications
        function renderNotifications() {
            const container = document.getElementById('notificationList');
            
            const filtered = currentFilter === 'all' 
                ? allNotifications 
                : allNotifications.filter(n => n.type === currentFilter);

            if (filtered.length === 0) {
                showEmptyNotifications();
                return;
            }

            container.innerHTML = filtered.map(notif => `
                <div class="notification-item ${notif.type}">
                    <div class="notification-header">
                        <span class="notification-type ${notif.type}">
                            ${notif.type === 'timeout' ? 'âš ï¸ íƒ€ì„ì•„ì›ƒ' : 'âœ… ë³µêµ¬'}
                        </span>
                        <span class="notification-time">${notif.date} ${notif.time}</span>
                    </div>
                    <div class="notification-name">${notif.name}</div>
                    <div class="notification-ip">${notif.ip}</div>
                </div>
            `).join('');
        }

        // Show Empty Notifications
        function showEmptyNotifications() {
            const container = document.getElementById('notificationList');
            container.innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“­</div>
                    <div>ì•„ì§ ì•Œë¦¼ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>
                </div>
            `;
        }

        // Update Loop
        function startUpdates() {
            updateInterval = setInterval(() => {
                loadData();
            }, 1000);
        }

        function stopUpdates() {
            if (updateInterval) {
                clearInterval(updateInterval);
            }
        }

        // ë¯¸ì‘ë‹µ ê¸°ë¡ ê´€ë¦¬ Functions (v2.6)
        async function loadOutages() {
            try {
                const response = await fetch('/data/outage_log.json?t=' + Date.now());
                const data = await response.json();
                allOutages = data.outages || [];
                renderOutages();
            } catch (error) {
                console.error('ë¯¸ì‘ë‹µ ë¡œê·¸ ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('outageList').innerHTML = '<div class="no-outages">ë¯¸ì‘ë‹µ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
            }
        }

        function renderOutages() {
            const container = document.getElementById('outageList');
            
            let filtered = allOutages.filter(o => {
                const statusMatch = currentOutageFilter.status === 'all' || o.status === currentOutageFilter.status;
                const groupMatch = currentOutageFilter.group === 'all' || o.group === currentOutageFilter.group;
                return statusMatch && groupMatch;
            });

            filtered.sort((a, b) => new Date(b.start_time) - new Date(a.start_time));

            if (filtered.length === 0) {
                container.innerHTML = '<div class="no-outages">ë¯¸ì‘ë‹µ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            container.innerHTML = filtered.map(outage => {
                let downtimeStr;
                if (outage.status === 'ongoing') {
                    const now = new Date();
                    const start = new Date(outage.start_time);
                    const seconds = Math.floor((now - start) / 1000);
                    downtimeStr = formatDuration(seconds) + ' (ì§„í–‰ ì¤‘)';
                } else {
                    downtimeStr = formatDuration(outage.downtime_seconds);
                }

                return `
                    <div class="outage-card ${outage.status}">
                        <div class="outage-header">
                            <span class="outage-status-badge ${outage.status}">
                                ${outage.status === 'ongoing' ? 'ğŸ”´ ì§„í–‰ì¤‘' : 'ğŸŸ¢ ë³µêµ¬ë¨'}
                            </span>
                            <span class="priority priority-${outage.priority}">P${outage.priority}</span>
                        </div>
                        <div class="outage-info">
                            <h3>${outage.name}</h3>
                            <p class="ip">${outage.ip}</p>
                            <p class="group">ê·¸ë£¹: ${outage.group}</p>
                        </div>
                        <div class="outage-timeline">
                            <div class="timeline-item">
                                <span class="label">ì‹œì‘:</span>
                                <span class="time">${formatTime(outage.start_time)}</span>
                            </div>
                            ${outage.end_time ? `
                            <div class="timeline-item">
                                <span class="label">ì¢…ë£Œ:</span>
                                <span class="time">${formatTime(outage.end_time)}</span>
                            </div>
                            ` : ''}
                            <div class="timeline-item">
                                <span class="label">ë‹¤ìš´íƒ€ì„:</span>
                                <span class="time">${downtimeStr}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function formatDuration(seconds) {
            if (!seconds) return '0ì´ˆ';
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;

            if (hours > 0) {
                return `${hours}ì‹œê°„ ${minutes}ë¶„`;
            } else if (minutes > 0) {
                return `${minutes}ë¶„ ${secs}ì´ˆ`;
            } else {
                return `${secs}ì´ˆ`;
            }
        }

        function formatTime(timeStr) {
            if (!timeStr) return 'N/A';
            const date = new Date(timeStr);
            return date.toLocaleString('ko-KR');
        }

        // Settings Functions - settings.jsë¡œ ì´ë™ë¨

    </script>

</body>
</html>